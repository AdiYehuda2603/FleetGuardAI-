# 🔐 מדריך מערכת Authentication - FleetGuard

## ✅ מה נוסף?

1. **מערכת כניסה והרשמה** - עמודים נפרדים לכניסה והרשמה
2. **אבטחת מפתח API** - המפתח לא מוצג יותר בסרגל הצד
3. **Session Management** - ניהול סשן משתמש
4. **מסד נתוני משתמשים** - שמירת משתמשים ב-SQLite

---

## 🚀 איך זה עובד?

### 1. עמוד כניסה (`pages/1_🔐_כניסה.py`)
- משתמשים קיימים יכולים להתחבר
- בדיקת שם משתמש וסיסמה
- הפניה אוטומטית לדשבורד לאחר התחברות

### 2. עמוד הרשמה (`pages/2_📝_הרשמה.py`)
- יצירת חשבון חדש
- בדיקת תקינות (סיסמה מינימלית, התאמת סיסמאות)
- מניעת כפילויות (שם משתמש ואימייל ייחודיים)

### 3. הגנה על הדשבורד (`main.py`)
- בדיקת authentication לפני כניסה
- הפניה אוטומטית לעמוד כניסה אם לא מחובר
- הצגת שם המשתמש בסרגל הצד
- כפתור התנתקות

---

## 🔒 אבטחת מפתח OpenAI

### לפני התיקון:
- ❌ המפתח היה מוצג בסרגל הצד (אפילו אם מוסתר)
- ❌ אפשר היה לראות חלק מהמפתח

### אחרי התיקון:
- ✅ המפתח לא מוצג כלל בסרגל הצד
- ✅ המפתח נטען אוטומטית מ-`.env` (אם קיים)
- ✅ אפשרות להזנה זמנית (רק לסשן הנוכחי) תחת expander
- ✅ המפתח נשמר רק ב-session, לא במסד נתונים

---

## 📁 קבצים חדשים

1. **`src/auth_manager.py`** - מנהל Authentication
   - רישום משתמשים
   - התחברות
   - ניהול session
   - ניהול מפתח API

2. **`pages/1_🔐_כניסה.py`** - עמוד כניסה
3. **`pages/2_📝_הרשמה.py`** - עמוד הרשמה
4. **`data/database/users.db`** - מסד נתוני משתמשים (נוצר אוטומטית)

---

## 🎯 שימוש

### משתמש חדש:
1. פתח את האפליקציה
2. לחץ על "הרשם כאן"
3. מלא את הפרטים
4. התחבר עם הפרטים שיצרת

### משתמש קיים:
1. פתח את האפליקציה
2. התחבר עם שם משתמש וסיסמה
3. תועבר אוטומטית לדשבורד

---

## 🔐 הגדרת מפתח OpenAI

### אופציה 1: קובץ .env (מומלץ - הכי בטוח)
צור קובץ `.env` בתיקיית `FleetGuard`:
```env
OPENAI_API_KEY=sk-your-key-here
```

המפתח יטען אוטומטית ולא יוצג כלל.

### אופציה 2: הזנה זמנית
1. פתח את הדשבורד
2. בסרגל הצד, לחץ על "הגדר מפתח API (זמני)"
3. הזן את המפתח
4. המפתח נשמר רק לסשן הנוכחי

---

## 🛡️ אבטחה

- ✅ סיסמאות מוצפנות (SHA-256 hash)
- ✅ מפתח API לא נשמר במסד נתונים
- ✅ מפתח API לא מוצג למשתמש
- ✅ בדיקת authentication בכל עמוד
- ✅ Session management מאובטח

---

## 📊 מסד נתונים

מסד הנתונים `users.db` מכיל:
- `id` - מזהה ייחודי
- `username` - שם משתמש (ייחודי)
- `email` - אימייל (ייחודי)
- `password_hash` - סיסמה מוצפנת
- `full_name` - שם מלא
- `created_at` - תאריך הרשמה
- `last_login` - תאריך כניסה אחרונה
- `is_active` - סטטוס פעיל/מושבת

---

## 🚀 מוכן לשימוש!

המערכת מוכנה עם:
- ✅ מערכת כניסה והרשמה מלאה
- ✅ אבטחת מפתח API משופרת
- ✅ ניהול משתמשים
- ✅ Session management

**הכל עובד! 🎉**

